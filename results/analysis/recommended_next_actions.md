# 推奨アクションプラン: 誤検知（FP）削減に向けて

今回の分布可視化分析（EDA）により、モデルが「死亡事故（TP）」と「誤検知（FP）」を区別できていない要因のいくつかが明らかになりました。
これに基づき、今後の精度向上（特に FP の削減）に向けた具体的なアクションを提案します。

## 1. 特徴量エンジニアリングの強化 (Priority: High)

「当事者B（相手方）」の規制情報が上位に来ていることから、**当事者AとBの力関係（優劣）や相互作用**が重要であることが示唆されます。

### A. 「関係性」特徴量の作成
単独の特徴量ではなく、AとBを組み合わせた特徴量を追加します。
- **規制のギャップ**: `一時停止規制（A）` vs `一時停止規制（B）`
    - パターン: (なし/あり), (あり/なし), (あり/あり), (なし/なし) の4パターンをカテゴリ化。
    - 仮説: 「相手だけが一時停止」の状況で事故が起きるのは、相手の不注意の可能性が高く、衝撃度合いも異なる可能性がある。
- **速度差**: `速度規制（A）` - `速度規制（B）`
    - 仮説: 速度差が大きい道路の交差や合流はリスクが高い。

### B. 道路環境のリスク細分化
`道路形状` や `地形` が上位にあることから、場所によるリスクをより詳細に捉えます。
- **Interaction**: `道路形状` × `地形` （例: 「下り坂」の「カーブ」）
- **エリア特性**: `area_id` ごとの事故発生率（Target Encoding）を、`road_type` 別に計算する。

---

## 2. モデル学習戦略の改善 (Priority: Medium)

### A. Hard Negative Mining (難易度別学習)
今回抽出された **「確信度の高いFP（閾値を超えてしまった負例）」** は、モデルにとって「紛らわしい難問」です。
これらを重点的に学習させる戦略をとります。

- **重み付け再学習**: 次回の Stage 2 学習時に、今回の分析で抽出された FPデータ (`fp_recall_0.99_thresh_...csv`) の `sample_weight` を増やす（例: 2倍〜5倍）。
- **目的**: モデルに「このパターンの誤検知はペナルティが大きい」と教え込む。

### B. 特徴量選択の再考
今回の分析で「乖離度が極端に低い（TP/FPで差がない）」特徴量は、ノイズになっている可能性があります。
- 下位の特徴量（Score < 0.01 など）を削除してモデルを軽量化・安定化させる実験を行う。

---

## 3. ポストプロセッシング検証 (Priority: Low)

再学習を行わずに、ルールベースで精度を上げるアプローチです。

- **リスクシナリオ別閾値**:
    - 全体一律の閾値（0.0177）ではなく、FP率が極端に高いセグメント（例: 「夜間」かつ「特定の規制なし」）に対してのみ、閾値を厳しく（高く）設定する。
- **減点ロジック**:
    - 「相手方に一時停止規制がある」ケースでFPが多いならば、その条件に合致する場合のみ予測確率を 0.9倍 するなどのヒューリスティックな補正をテストする。

---

## 次のステップへの提案

まずは **「1. 特徴量エンジニアリング」** から着手することをお勧めします。既存のデータを組み合わせるだけで、モデルが状況（コンテキスト）を理解しやすくなり、本質的な精度向上が見込めるからです。
