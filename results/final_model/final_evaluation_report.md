# 最終モデル評価レポート

**評価日時**: 2025年12月11日 14:29

## 1. 最終評価結果

| 指標 | 値 |
|------|-----|
| **PR-AUC** | **0.2056** |
| ROC-AUC | 0.8879 |
| 最適閾値 (F1最大化) | 0.7581 |

## 2. 閾値別の性能

| 閾値 | Precision | Recall | F1 |
|------|-----------|--------|----|
| 0.1 | 0.0567 | 0.7273 | 0.1053 |
| 0.2 | 0.0853 | 0.6345 | 0.1504 |
| 0.3 | 0.1109 | 0.5699 | 0.1857 |
| 0.4 | 0.1369 | 0.5189 | 0.2167 |
| 0.5 | 0.1646 | 0.4682 | 0.2436 |

## 3. データセット情報

- **データソース**: data/processed/honhyo_clean_predictable_only.csv
- **テストデータサイズ**: 379,055 件
- **テストデータの死亡件数**: 3,253 件

## 4. 使用パラメータ

```json
{
  "learning_rate": 0.07658346283890378,
  "num_leaves": 125,
  "max_depth": 8,
  "min_child_samples": 278,
  "subsample": 0.6147706754536576,
  "colsample_bytree": 0.6267708320804088,
  "reg_alpha": 0.9961403311275829,
  "reg_lambda": 8.228908331551605,
  "min_child_weight": 0.12646850234127796,
  "min_split_gain": 0.24303906753172422,
  "path_smooth": 2.254892007170922,
  "scale_pos_weight": 61.47728365878301,
  "objective": "binary",
  "metric": "binary_logloss",
  "boosting_type": "gbdt",
  "n_estimators": 10000,
  "random_state": 42,
  "n_jobs": -1,
  "verbose": -1
}
```

---

## 5. 特徴量重要度 (Top 10)

| 順位 | 特徴量 | 重要度 | 解釈 |
|------|--------|--------|------|
| 1 | 地点　緯度（北緯） | 25,366 | 地理的位置が最重要 |
| 2 | 地点　経度（東経） | 25,229 | 地理的位置が最重要 |
| 3 | 市区町村コード | 21,114 | 地域特性の影響大 |
| 4 | 警察署等コード | 20,794 | 地域・管轄の影響 |
| 5 | 路線コード | 20,404 | 道路種別が重要 |
| 6 | 車道幅員 | 10,364 | 道路の幅が影響 |
| 7 | 当事者種別（当事者A） | 10,028 | 車種（二輪車等）が重要 |
| 8 | 地点コード | 9,226 | 詳細な位置情報 |
| 9 | 曜日(発生年月日) | 9,216 | 曜日パターンの存在 |
| 10 | 年齢（当事者A） | 8,070 | 運転者年齢の影響 |

---

## 6. 考察と知見

### 6.1 モデル性能の評価

#### ✅ 良好な点

1. **過学習していない**
   - 交差検証時のPR-AUC: 0.1779
   - テストセットのPR-AUC: **0.2056**（+15.6%向上）
   - テストデータで性能が向上したことは、モデルが良好に汎化していることを示す

2. **高いROC-AUC (0.8879)**
   - 死亡/非死亡の識別能力は十分に高い
   - ランダム予測(0.5)を大きく上回る

3. **強い正則化の効果**
   - `min_child_samples=278`（通常20-50）という非常に大きな値
   - `reg_lambda=8.23`という強いL2正則化
   - これらがモデルの汎化性能向上に貢献

#### ⚠️ 課題

1. **低いPrecision**
   - 閾値0.5でもPrecision 16.5%（6件中5件は誤警報）
   - 死亡事故の稀少性（0.86%）が原因

2. **Precision-Recallのトレードオフ**
   - Recall 70%を達成するにはPrecision 5.7%まで低下
   - 実運用では目的に応じた閾値設定が必要

### 6.2 特徴量からの知見

#### 🗺️ 地理的要因が最重要

上位5特徴量中4つが位置・地域情報：
- **緯度・経度**: 特定の「危険地点」が存在する可能性
- **市区町村・警察署コード**: 都市部vs地方、交通量の違い
- **路線コード**: 高速道路、国道、県道など道路種別の影響

**示唆**: 死亡事故は「どこで起きたか」に強く依存する。特定の危険地点・路線の特定が重要。

#### 🚗 道路構造の影響

- **車道幅員** (6位): 狭い道路は危険度が高い可能性
- **道路線形** (15位): カーブ、直線などの形状
- **中央分離帯** (16位): 分離帯の有無が正面衝突リスクに影響

#### 👤 運転者属性

- **当事者種別** (7位): 二輪車、自転車、歩行者は死亡リスクが高い
- **年齢** (10位): 高齢者・若年者のリスク差

#### ⏰ 時間的パターン

- **曜日** (9位): 週末と平日で事故パターンが異なる
- **昼夜** (13位): 夜間は視認性低下で危険度上昇

### 6.3 実用化に向けた提言

#### 運用シナリオ別の閾値設定

| 目的 | 推奨閾値 | Precision | Recall | ユースケース |
|------|----------|-----------|--------|-------------|
| **見逃し最小化** | 0.1 | 5.7% | 72.7% | 警報システム（多少の誤警報を許容） |
| **バランス型** | 0.3-0.4 | 11-14% | 52-57% | リスクスコアリング |
| **高確信予測** | 0.76 | 26.1% | 32.2% | 重点対策地点の特定 |

#### 活用案

1. **ホットスポット分析**
   - 緯度・経度の重要度が高いため、危険地点のクラスタリングが有効
   - 地図上での可視化により対策優先度を決定

2. **条件別リスク評価**
   - 「夜間 × 二輪車 × 狭い道路」などの高リスク組み合わせ特定
   - SHAP分析で個別予測の説明が可能

3. **予防的アラート**
   - カーナビ等で高リスク地点・条件を事前通知
   - 閾値0.1で広く警告、重大リスクのみ閾値0.5以上で強調表示

### 6.4 限界と今後の課題

1. **データリーケージの可能性**
   - 「事故類型」が特徴量に残っている（重要度19位）
   - 事故後にしか判明しない情報の可能性があり、要確認

2. **時系列の考慮**
   - 現在はランダム分割だが、時系列での評価が望ましい
   - 過去データで学習→未来データで評価

3. **地域差の検討**
   - 都道府県別のモデル性能差を分析
   - 地域特化モデルの検討

4. **外部データの統合**
   - 交通量データ、天気詳細データ、道路設備データの追加
   - より精度の高い予測が期待できる

---

## 7. 結論

本モデルは、**約190万件の交通事故データ**から死亡事故を予測するLightGBMモデルである。

**主な成果**:
- テストデータでPR-AUC 0.2056、ROC-AUC 0.8879を達成
- 過学習なく汎化性能を確保
- 地理的位置が死亡事故予測の最重要因子であることを発見

**実用的価値**:
- 死亡事故の約70%を事前に警告可能（閾値0.1時）
- 危険地点・条件の特定により予防的対策が可能

**卒業研究としての意義**:
- 機械学習による交通安全への貢献可能性を実証
- データ駆動型の政策立案への基礎資料となりうる
