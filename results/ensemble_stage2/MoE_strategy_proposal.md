# 専門家モデル (Mixture of Experts) 導入に向けた分析レポート

## 1. 目的
現在のアンサンブルモデル（Stage 2）でも判定が難しい「難関データ」の特徴を特定し、
Expert A, Expert B... といった「専門家モデル」をどのように設計すべきか提案します。

## 2. 「判定が難しい事故」の正体

分析の結果、モデルが**「誤検知（False Positive）」してしまうデータ**には明確な特徴がありました。
これらは「事故が起きそうな条件が揃っているのに、実際には起きていない」ケースです。

| 特徴カテゴリ | 具体的な値 | 誤検知における増加率 | 考察 |
| :--- | :--- | :--- | :--- |
| **地形** | **コード3 (市街地・人口密集地)** | **+43.7%** (極めて高い) | 「市街地＝危険」という単純なパターンに過剰反応しています。生活道路の複雑さが原因と思われます。 |
| **道路形状** | **コード13 (カーブ・屈折)** | **+23.1%** | 「カーブ＝危険」と思い込んでいます。 |
| **信号機** | **コード7 (その他・信号なし)** | **+16.6%** | 明確な交通整理が行われていない場所での予測が不安定です。 |
| **昼夜** | **コード22 (夜間・照明あり)** | **+11.6%** | 「夜＝危険」というバイアスが強いです。 |

## 3. 提案する Mixture of Experts (MoE) 構成

上記の苦手分野を克服するため、Stage 3（またはStage 2の拡張）として以下の専門家モデルを配置することを提案します。

### 👮 Expert A: 「市街地・生活道路」専門モデル
*   **担当領域**: 地形コード3、信号機コード7（信号なし）
*   **役割**: 人口密集地特有の「歩行者・自転車の飛び出し」や「複雑な交差点」のパターンを深く学習します。
*   **期待効果**: 現在最も多い「市街地での誤検知」を劇的に減らせる可能性があります。
*   **追加したいデータ**: ゾーン30の有無、近くの学校・公園の位置情報。

### 🌃 Expert B: 「夜間・視界不良」専門モデル
*   **担当領域**: 昼夜コード22/23、天候コード2（曇・雨）
*   **役割**: 視界が悪い状況下での事故要因（街灯のなさ、路面反射など）に特化します。
*   **期待効果**: 「夜だからとりあえず危険」という大雑把な予測ではなく、本当に危険な夜道だけを見抜けるようになります。

### 🏎️ Expert C: 「カーブ・構造」専門モデル
*   **担当領域**: 道路形状コード13（カーブ）、地形コード1/2（山地等）
*   **役割**: 道路の構造的な危険性を評価します。
*   **追加したいデータ**: 実際のカーブの曲率半径（もしあれば）、制限速度。

## 4. 実行プラン
まずは **Expert A（市街地モデル）** の導入が最も効果的です。誤検知の半数以上がこの領域に関係しているため、ここを制すればPrecision 80%超えも現実味を帯びてきます。
