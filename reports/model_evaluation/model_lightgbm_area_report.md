# LightGBMモデル評価レポート（エリアID化・不均衡対策版）

## 実験概要
- **モデル**: LightGBM (Gradient Boosting Decision Tree)
- **データ**: `honhyo_clean_predictable_only.csv` (全1,895,275件)
- **特徴量**: 34カラム（緯度経度をエリアID化、日時を分解、全変数カテゴリカル化）
- **不均衡対策**: `scale_pos_weight = 115.51`
- **検証方法**: Stratified K-Fold (5分割)

## 📊 評価結果サマリー

| 指標 | 平均スコア | 説明 |
|------|-----------|------|
| **AUC** | **0.8806** | モデルの総合的な識別能力（非常に高い）|
| **Recall** | **0.7480** | 死亡事故の検知率（約75%を正しく予測）|
| **Precision** | **0.0466** | 死亡予測の的中率（低いが不均衡データでは想定内）|
| **Accuracy** | **0.8663** | 全体の正解率 |
| **F1 Score** | **0.0877** | RecallとPrecisionの調和平均 |

### 考察
- **高いAUC (0.88)**: モデルは死亡事故と負傷事故を明確に区別できています。
- **Recall 75%**: 死亡事故の4件に3件を事前に「危険」と予測できており、予防モデルとして一定の実用性があります。
- **低いPrecision**: 「危険」と予測したものの多くは実際には死亡事故に至っていませんが、これは「ヒヤリハット」や「潜在的な危険」を含んでいる可能性があり、安全運転支援としては許容範囲と考えられます。

## 📈 Feature Importance（重要度上位）

生成された `feature_importance.png` を参照してください。
一般的に以下の要因が重要視される傾向にあります：
1. **エリアID (`area_id`)**: 地理的な事故多発地点
2. **年齢 (`年齢（当事者A）`)**: 運転者の年齢
3. **時間帯 (`hour` / `昼夜`)**: 視界や交通量の変化
4. **道路形状・構造**: 交差点、カーブなど
5. **相手の行動 (`一時停止規制`等)**: 相手側の道路環境

## 📂 出力ファイル
- `metrics.csv`: 各Foldのスコア
- `metrics_mean.csv`: 平均スコア
- `feature_importance.csv`: 特徴量重要度データ
- `feature_importance.png`: 重要度グラフ
- `confusion_matrix.png`: 混同行列図

## 🚀 次のアクション案
- **閾値の調整**: Recallを80%以上に上げるため、予測確率の閾値を調整する。
- **エリアIDの解像度変更**: クラスター数（500）を増減させて感度を確認する。
- **SHAP解析**: なぜその予測になったかの要因分析。
