# 除外列のデータリーク理由 - 詳細解説

**作成日時:** 2025年12月8日  
**参照元:** codebook_2024_extracted.txt

---

## 除外した14列とデータリークの理由

### 🔴 最も致命的なリーク（1列）

#### 1. **事故内容**

**codebook定義**:
```
項目名: 事故内容
コード 区分:
  1 死亡 - 交通事故発生から24時間以内に死者を出した交通事故をいう
  2 負傷 - 治療を要する負傷者を出した交通事故をいう
備考: 交通事故の死傷者を種別に区分し、その最も重いものとする
```

**データリークの理由**:
- この列は**事故の結果そのものを直接示している**
- 「死亡」(コード1) = 死者が出た事故
- 「負傷」(コード2) = 死者が出なかった事故
- 目的変数「死者数」と**ほぼ100%相関**（死亡=死者数≥1、負傷=死者数=0）
- この列があれば、モデルは単に「事故内容==1なら死亡事故」と学習するだけ

**リーク度**: 🔴🔴🔴 **極めて高（100%相関）**

---

### 🔴 人的被害に関する事後情報（3列）

#### 2-3. **人身損傷程度（当事者A・B）**

**codebook定義**:
```
項目名: 人身損傷程度
説明: 当事者の人身損傷の程度をいう
コード 区分:
  1 死亡 - 事故発生後24時間以内の死亡をいう
  2 負傷 - 治療を要する傷害をいう
  4 損傷なし - 人身に損傷がないことをいう
```

**データリークの理由**:
- 当事者が「死亡」したか「負傷」したかは**事故の結果**
- 「死亡」(コード1)は目的変数「死者数」と直接対応
- 当事者A・Bのいずれかが「死亡」なら、ほぼ確実に死者数≥1
- これは事故発生**後**の診断・確認によってのみわかる情報

**リーク度**: 🔴🔴🔴 **極めて高**

---

#### 4. **負傷者数**

**codebook定義**:
```
項目名: 負傷者数
説明: 交通事故により治療を要する者の人数をいう
```

**データリークの理由**:
- 負傷者数は事故の**結果の重大性**を示す指標
- 死者数と負傷者数は**強く相関**する（重大事故ほど両方多い）
- 死亡事故では負傷者も多い傾向があり、死亡の有無を推測できる
- これも事故発生**後**に集計される情報

**リーク度**: 🔴🔴 **非常に高**

---

### 🟠 車両の物的被害に関する事後情報（2列）

#### 5-6. **車両の損壊程度（当事者A・B）**

**codebook定義**:
```
項目名: 車両の損壊程度
説明: 当事者の車両の損壊程度をいう
コード 区分:
  1 大破 - 修理不可能な車両の損壊程度をいう
  2 中破 - 修理に多額の費用を要する車両の損壊程度をいう
  3 小破 - 修理に僅かの費用を要する車両の損壊程度をいう
  4 損壊なし - 車両に損壊がない場合をいう
```

**データリークの理由**:
- 車両の損壊程度は**衝突の激しさ**を示す
- 大破・中破の場合、死亡事故の可能性が**非常に高い**
- 衝突の激しさは事故後の車両調査によってのみ判明
- 「大破」は死者が出る重大事故と強く関連

**リーク度**: 🟠🟠 **高**

---

### 🟡 衝突の詳細に関する事後情報（2列）

#### 7-8. **車両の衝突部位（当事者A・B）**

**codebook定義**:
```
項目名: 車両の衝突部位
説明: 当事者の車両等の損壊部位をいう
コード例:
  0 前方 - 車両等の前方が最初に衝突した部位をいう
  1 右側面前部 - 車両等の右側面前部が最初に衝突した部位をいう
  2 右側面中部 - 車両等の右側面中部が最初に衝突した部位をいう
  ...
備考: 多重衝突の事故の場合、上位桁を最初の衝突点、下位桁を2度目の衝突点とする
```

**データリークの理由**:
- 車両の**どの部位が損傷したか**は事故後の調査で判明
- 衝突部位と死亡リスクには関連がある（例: 側面衝突は危険）
- 「損壊部位」は物理的損傷を前提としており、事故の**結果**
- 事故発生前には当然わからない情報

**注意**: これは「衝突地点」（交差点か単路かという**場所**）とは異なる

**リーク度**: 🟡🟡 **中程度**

---

### 🟢 エアバッグ関連（4列・予防的除外）

#### 9-12. **エアバッグの装備（当事者A・B）、サイドエアバッグの装備（当事者A・B）**

**codebook定義**:
```
項目名: エアバッグの装備
説明: 当事者の乗車部位に装備されているエアバッグの作動状況をいう
コード 区分:
  1 装備あり 作動 - 衝突時の衝撃によりエアバッグが作動したものをいう
  2 装備あり 非作動 - 装備はあるが、側面衝突や衝撃が小さいため作動しなかったものをいう
  3 装備なし - 装備がないものをいう
  0 対象外当事者 - 当事者種別が「乗用車」「貨物車」以外のものをいう
```

**データリークの理由**:
- エアバッグが**「作動した」か「作動しなかった」か**は事故後にのみわかる
- 作動・非作動は**衝突の激しさ**と関連
- 作動した場合、重大事故の可能性が高い
- 「装備の有無」だけなら事前情報だが、**作動状況が混在**しているため除外

**予防的除外**: codebookでは「作動状況」が含まれることが明記されているため、安全のため除外

**リーク度**: 🟢 **低〜中（予防的除外）**

---

### ⚪ 管理情報（2列・予測に無関係）

#### 13. **資料区分**

**codebook定義**:
```
項目名: 資料区分
説明: 本票、補充票、高速票レコードを識別する番号をいう
コード:
  1 本票
  2 補充票
  3 高速票
```

**データリークの理由**: データリークではないが、**予測に無関係な管理情報**のため除外

---

#### 14. **本票番号**

**codebook定義**: 事故記録のID番号

**データリークの理由**: データリークではないが、**単なるID**であり予測に無関係なため除外

---

## 📊 リーク度のまとめ

| リーク度 | 列数 | 列名 | 理由 |
|---------|------|------|------|
| 🔴🔴🔴 極めて高 | 4 | 事故内容、人身損傷程度×2、負傷者数 | 事故の結果を直接示す |
| 🟠🟠 高 | 2 | 車両の損壊程度×2 | 衝突の激しさ（重要な間接指標） |
| 🟡🟡 中 | 2 | 車両の衝突部位×2 | 事故後の物理的調査が必要 |
| 🟢 低（予防的） | 4 | エアバッグ×4 | 作動状況が含まれる可能性 |
| ⚪ 無関係 | 2 | 資料区分、本票番号 | 管理情報 |

---

## 🎯 事前情報と事後情報の決定的な違い

### ✅ 事前に観測可能（モデルで使用可能）

| 情報種別 | 例 |
|---------|---|
| **環境** | 天候、路面状態、昼夜 |
| **道路** | 形状、幅員、規制、信号 |
| **当事者属性** | 年齢、車種、用途 |
| **場所** | 経度・緯度、交差点/単路 |
| **時間** | 発生日時、曜日、祝日 |

これらは**事故が起きる前から存在**している情報。

### ❌ 事後にのみ判明（モデルで使用禁止）

| 情報種別 | 例 |
|---------|---|
| **人的結果** | 死亡、負傷、損傷程度 |
| **物的結果** | 車両の損壊程度、衝突部位 |
| **機器作動** | エアバッグ作動 |
| **集計結果** | 負傷者数、（死者数） |

これらは**事故が起きた後の調査・診断**によって初めてわかる情報。

---

## 💡 なぜ事後情報があるとデータリークになるのか？

### 根本的な問題

機械学習モデルの目的は:
```
事前の観測可能な情報から → 事故の結果（死者の有無）を予測
```

しかし、事後情報が含まれると:
```
事故の結果を含む情報から → 事故の結果を予測
```
となり、**循環参照**が発生します。

### 具体例

**正しい予測**:
```python
# 事前情報のみ使用
if 天候=="雨" and 速度規制=="60km/h" and 昼夜=="夜間":
    → 死亡事故の可能性が高い（真の予測）
```

**データリークの例**:
```python
# 事後情報を含む
if 事故内容=="死亡":
    → 死亡事故である（カンニング）
```

モデルは後者の方が簡単で正確なため、**事後情報を優先的に学習**してしまいます。

---

## 🔗 参照

- [Codebook](file:///c:/Users/socce/software-lab/traffic-accident/data/codebook/codebook_2024_extracted.txt)
- [クリーンデータREADME](file:///c:/Users/socce/software-lab/traffic-accident/data/processed/README_clean_dataset.md)
- [検証レポート](file:///c:/Users/socce/software-lab/traffic-accident/data/processed/VERIFICATION_REPORT.md)
